<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eventify - University Club Event Management Platform</title>
    <meta name="description" content="Discover and register for university club events. Join exciting activities, meet new people, and enhance your campus experience.">
    
    <!-- Tailwind CSS -->
    <link href="./styles/output.css" rel="stylesheet">
    
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    

    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="./assets/img/logo.svg">
</head>
<body class="bg-brand-surface text-brand-text font-body min-h-screen">
    <!-- Navigation -->
    <nav class="nav-blur sticky top-0 z-40">
        <div class="container-custom">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-brand-primary to-brand-accent rounded-xl flex items-center justify-center glow-effect">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <span class="text-xl font-bold text-gradient">Eventify</span>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html" class="text-brand-text hover:text-brand-primary transition-colors font-medium">Home</a>
                    <a href="events.html" class="text-brand-muted hover:text-brand-text transition-colors">Events</a>
                    <a href="faq.html" class="text-brand-muted hover:text-brand-text transition-colors">FAQ</a>
                    
                    <!-- Guest Navigation -->
                    <div data-auth="guest" class="flex items-center space-x-4">
                        <a href="auth-new.html" class="btn btn-ghost">Login</a>
                        <a href="auth-new.html#signup" class="btn btn-primary">Sign Up</a>
                    </div>

                    <!-- Authenticated Navigation -->
                    <div data-auth="required" class="hidden flex items-center space-x-4">
                        <a href="dashboard.html" data-auth="student" class="text-brand-muted hover:text-brand-text transition-colors">Dashboard</a>
                        <a href="admin-dashboard.html" data-auth="admin" class="text-brand-muted hover:text-brand-text transition-colors">Admin</a>
                        
                        <!-- User Menu -->
                        <div class="relative" id="user-menu">
                            <button class="flex items-center space-x-2 text-brand-text hover:text-brand-primary transition-colors">
                                <div class="w-8 h-8 bg-gradient-to-br from-brand-primary to-brand-accent rounded-full flex items-center justify-center" id="user-avatar">
                                    <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <span id="user-name" class="font-medium">User</span>
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414L10 11.414l-3.293 3.293a1 1 0 01-1.414-1.414L8.586 10 5.293 6.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                            
                            <!-- Dropdown Menu -->
                            <div class="absolute right-0 mt-2 w-48 glass-effect rounded-2xl shadow-2xl opacity-0 invisible transition-all duration-200">
                                <div class="py-2">
                                    <a href="profile.html" class="block px-4 py-2 text-sm text-brand-text hover:bg-white/5 transition-colors">Profile</a>
                                    <a href="settings.html" class="block px-4 py-2 text-sm text-brand-text hover:bg-white/5 transition-colors">Settings</a>
                                    <hr class="border-white/10 my-2">
                                    <button id="logout-btn" class="block w-full text-left px-4 py-2 text-sm text-brand-danger hover:bg-white/5 transition-colors">Logout</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Theme Toggle -->
                <button id="theme-toggle" class="p-2 text-brand-muted hover:text-brand-text transition-colors rounded-xl hover:bg-white/5">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"/>
                    </svg>
                </button>

                <!-- Mobile Menu Button -->
                <button id="mobile-menu-button" class="md:hidden p-2 text-brand-muted hover:text-brand-text transition-colors rounded-xl hover:bg-white/5">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
                    </svg>
                </button>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden pb-4 border-t border-white/10">
                <div class="flex flex-col space-y-4 pt-4">
                    <a href="index.html" class="text-brand-text hover:text-brand-primary transition-colors font-medium">Home</a>
                    <a href="events.html" class="text-brand-muted hover:text-brand-text transition-colors">Events</a>
                    <a href="faq.html" class="text-brand-muted hover:text-brand-text transition-colors">FAQ</a>
                    
                    <!-- Guest Mobile Navigation -->
                    <div data-auth="guest" class="flex flex-col space-y-2">
                        <a href="auth-new.html" class="btn btn-ghost w-full justify-center">Login</a>
                        <a href="auth-new.html#signup" class="btn btn-primary w-full justify-center">Sign Up</a>
                    </div>

                    <!-- Authenticated Mobile Navigation -->
                    <div data-auth="required" class="hidden flex flex-col space-y-2">
                        <a href="dashboard.html" data-auth="student" class="text-brand-muted hover:text-brand-text transition-colors">Dashboard</a>
                        <a href="admin-dashboard.html" data-auth="admin" class="text-brand-muted hover:text-brand-text transition-colors">Admin</a>
                        <a href="profile.html" class="text-brand-muted hover:text-brand-text transition-colors">Profile</a>
                        <a href="settings.html" class="text-brand-muted hover:text-brand-text transition-colors">Settings</a>
                        <button id="mobile-logout-btn" class="text-left text-brand-danger hover:text-brand-danger/80 transition-colors">Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="floating-elements">
        <!-- Enhanced Hero Section -->
        <section class="section-padding relative overflow-hidden">
            <div class="hero-gradient absolute inset-0"></div>
            <!-- Enhanced floating elements -->
            <div class="absolute top-20 left-20 w-32 h-32 bg-gradient-to-br from-brand-primary/20 to-transparent rounded-full filter blur-2xl animate-float"></div>
            <div class="absolute bottom-20 right-20 w-40 h-40 bg-gradient-to-br from-brand-accent/20 to-transparent rounded-full filter blur-2xl animate-float-slow"></div>
            <div class="absolute top-1/2 left-10 w-24 h-24 bg-gradient-to-br from-transparent to-brand-primary/20 rounded-full filter blur-xl animate-pulse-slow"></div>
            <div class="absolute top-1/3 right-16 w-20 h-20 bg-gradient-to-br from-brand-accent/20 to-transparent rounded-full filter blur-xl animate-pulse"></div>
            
            <div class="container-custom relative z-10">
                <div class="text-center max-w-6xl mx-auto animate-fade-in">
                    <h1 class="heading-large mb-10">
                        Discover & Join
                        <span class="text-gradient bg-gradient-to-r from-brand-primary via-brand-accent to-brand-primary bg-clip-text text-transparent">University Club Events</span>
                    </h1>
                    <p class="text-lead mb-16 max-w-4xl mx-auto text-brand-text/90 leading-relaxed">
                        Connect with your campus community through exciting events, workshops, and activities organized by university clubs. 
                        Build lasting friendships and create unforgettable memories.
                    </p>

                    <!-- Enhanced Search Bar -->
                    <div class="max-w-3xl mx-auto mb-16">
                        <div class="relative group">
                            <input 
                                type="text" 
                                placeholder="Search events, clubs, or categories..." 
                                class="w-full px-8 py-6 pl-16 text-xl bg-white/15 backdrop-blur-md border-2 border-white/25 rounded-3xl text-brand-text placeholder-brand-muted/70 focus:outline-none focus:ring-4 focus:ring-brand-primary/30 focus:border-brand-primary/50 transition-all duration-500 group-hover:border-white/40 group-hover:bg-white/20"
                                id="hero-search"
                            >
                            <svg class="absolute left-6 top-1/2 transform -translate-y-1/2 w-7 h-7 text-brand-muted group-hover:text-brand-primary transition-colors duration-300" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                            </svg>
                            <button class="absolute right-3 top-1/2 transform -translate-y-1/2 btn btn-primary px-8 py-3 text-lg rounded-2xl hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl" id="hero-search-btn">
                                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                Search
                            </button>
                            
                            <!-- Enhanced glow effect -->
                            <div class="absolute inset-0 bg-gradient-to-r from-brand-primary/20 to-brand-accent/20 rounded-3xl blur-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 -z-10"></div>
                        </div>
                        
                        <!-- Search suggestions -->
                        <div class="flex items-center justify-center mt-6 space-x-4 text-sm text-brand-muted/70">
                            <span class="flex items-center space-x-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                <span>Popular: Tech Talks</span>
                            </span>
                            <span class="flex items-center space-x-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                <span>Sports Events</span>
                            </span>
                            <span class="flex items-center space-x-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                                <span>Workshops</span>
                            </span>
                        </div>
                    </div>



                    <!-- Enhanced CTA Section -->
                    <div class="flex flex-col sm:flex-row gap-6 justify-center items-center mb-16">
                        <a href="events.html" class="btn btn-primary text-lg px-10 py-5 glow-effect hover:scale-105 transition-all duration-300 group">
                            <svg class="w-5 h-5 mr-2 group-hover:rotate-12 transition-transform duration-300" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            Browse Events
                        </a>
                        <a href="auth-new.html#signup" class="btn btn-ghost text-lg px-10 py-5 hover:scale-105 transition-all duration-300 group border-2 border-white/20 hover:border-white/40">
                            <svg class="w-5 h-5 mr-2 group-hover:scale-110 transition-transform duration-300" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                            </svg>
                            Get Started
                        </a>
                    </div>

                    <!-- Decorative Elements -->
                    <div class="relative">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-32 h-1 bg-gradient-to-r from-transparent via-brand-primary/30 to-transparent"></div>
                        </div>
                        <div class="relative z-10 flex items-center justify-center space-x-4">
                            <div class="w-3 h-3 bg-brand-primary rounded-full animate-pulse"></div>
                            <div class="w-2 h-2 bg-brand-accent rounded-full animate-pulse" style="animation-delay: 0.2s"></div>
                            <div class="w-3 h-3 bg-brand-primary rounded-full animate-pulse" style="animation-delay: 0.4s"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Featured Events Section -->
        <section class="section-padding relative overflow-hidden">
            <!-- Enhanced Background Elements -->
            <div class="absolute inset-0 bg-gradient-to-br from-brand-primary/5 via-transparent to-brand-accent/5"></div>
            <div class="absolute top-20 left-10 w-72 h-72 bg-gradient-to-br from-brand-primary/20 to-brand-accent/20 rounded-full filter blur-3xl animate-float"></div>
            <div class="absolute bottom-20 right-10 w-96 h-96 bg-gradient-to-br from-brand-accent/20 to-brand-primary/20 rounded-full filter blur-3xl animate-float-slow"></div>
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-br from-brand-primary/10 to-transparent rounded-full filter blur-2xl animate-pulse-slow"></div>
            
            <div class="container-custom relative z-10">
                <div class="text-center mb-20 animate-slide-up">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-brand-primary/30 to-brand-accent/30 rounded-3xl mb-8 shadow-2xl backdrop-blur-sm">
                        <svg class="w-10 h-10 text-brand-primary" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <h2 class="heading-medium mb-8 text-gradient">
                        Discover Amazing Events
                    </h2>
                    <p class="text-lead max-w-3xl mx-auto text-brand-text/90">
                        Explore a curated selection of upcoming events, workshops, and activities that will enrich your university experience
                    </p>
                    
                    <!-- Decorative line with dots -->
                    <div class="flex items-center justify-center mt-8 space-x-2">
                        <div class="w-2 h-2 bg-brand-primary rounded-full"></div>
                        <div class="w-1 h-1 bg-brand-accent rounded-full"></div>
                        <div class="w-2 h-2 bg-brand-primary rounded-full"></div>
                    </div>
                </div>

                <!-- Events Grid -->
                <div id="events-grid" class="grid-responsive">
                    <!-- Loading State -->
                    <div class="col-span-full text-center py-12">
                        <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-brand-primary/20 to-brand-accent/20 rounded-2xl mb-4 animate-pulse">
                            <svg class="w-8 h-8 text-brand-primary" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h3 class="text-lg font-semibold text-brand-text mb-2">Loading Events...</h3>
                        <p class="text-brand-muted">Please wait while we fetch the latest events</p>
                    </div>
                </div>

                <!-- Enhanced View All Button -->
                <div class="text-center mt-20">
                    <div class="relative inline-block group">
                        <a href="events.html" class="btn btn-primary px-16 py-6 text-xl glow-effect hover:scale-105 transition-all duration-500 group-hover:shadow-2xl group-hover:shadow-brand-primary/25">
                            <svg class="w-6 h-6 mr-3 group-hover:rotate-12 transition-transform duration-300" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            Explore All Events
                        </a>
                        <!-- Glow effect -->
                        <div class="absolute inset-0 bg-gradient-to-r from-brand-primary to-brand-accent rounded-2xl blur-xl opacity-0 group-hover:opacity-30 transition-opacity duration-500 -z-10"></div>
                    </div>
                    
                    <!-- Decorative elements -->
                    <div class="flex items-center justify-center mt-8 space-x-3">
                        <div class="w-1 h-1 bg-brand-primary rounded-full animate-pulse"></div>
                        <div class="w-2 h-2 bg-brand-accent rounded-full animate-pulse" style="animation-delay: 0.2s"></div>
                        <div class="w-1 h-1 bg-brand-primary rounded-full animate-pulse" style="animation-delay: 0.4s"></div>
                    </div>
                </div>
            </div>
        </section>



        <!-- Enhanced CTA Section -->
        <section class="section-padding relative overflow-hidden">
            <!-- Enhanced Background Elements -->
            <div class="absolute inset-0 bg-gradient-to-br from-brand-accent/10 via-transparent to-brand-primary/10"></div>
            <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-full h-1 bg-gradient-to-r from-transparent via-brand-primary/40 to-transparent"></div>
            <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 w-full h-1 bg-gradient-to-r from-transparent via-brand-accent/40 to-transparent"></div>
            <div class="absolute top-1/4 right-10 w-32 h-32 bg-gradient-to-br from-brand-accent/20 to-transparent rounded-full filter blur-2xl animate-float"></div>
            <div class="absolute bottom-1/4 left-10 w-40 h-40 bg-gradient-to-br from-brand-primary/20 to-transparent rounded-full filter blur-2xl animate-float-slow"></div>
            
            <div class="container-custom relative z-10">
                <div class="max-w-5xl mx-auto text-center">
                    <div class="inline-flex items-center justify-center w-24 h-24 bg-gradient-to-br from-brand-accent/30 to-brand-primary/30 rounded-3xl mb-10 animate-pulse-slow shadow-2xl backdrop-blur-sm">
                        <svg class="w-12 h-12 text-brand-accent" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    
                    <h2 class="heading-medium mb-8 text-gradient">
                        Ready to Transform Your Campus Experience?
                    </h2>
                    <p class="text-lead mb-16 max-w-3xl mx-auto text-brand-text/90">
                        Join a vibrant community of students discovering, creating, and participating in amazing university events
                    </p>
                    
                    <div class="flex flex-col sm:flex-row gap-8 justify-center items-center mb-12">
                        <div class="relative group">
                            <a href="auth-new.html#signup" class="btn btn-primary text-xl px-16 py-6 glow-effect hover:scale-105 transition-all duration-500 group-hover:shadow-2xl group-hover:shadow-brand-primary/25">
                                <svg class="w-6 h-6 mr-3 group-hover:scale-110 transition-transform duration-300" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Start Your Journey
                            </a>
                            <!-- Enhanced glow effect -->
                            <div class="absolute inset-0 bg-gradient-to-r from-brand-primary to-brand-accent rounded-2xl blur-xl opacity-0 group-hover:opacity-30 transition-opacity duration-500 -z-10"></div>
                        </div>
                        
                        <div class="relative group">
                            <a href="auth-new.html" class="btn btn-ghost text-xl px-16 py-6 hover:scale-105 transition-all duration-500 border-2 border-white/30 hover:border-white/50 hover:bg-white/5">
                                <svg class="w-6 h-6 mr-3 group-hover:rotate-12 transition-transform duration-300" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="false"/>
                                </svg>
                                Welcome Back
                            </a>
                        </div>
                    </div>
                    
                    <!-- Enhanced decorative elements -->
                    <div class="flex items-center justify-center space-x-6">
                        <div class="w-3 h-3 bg-brand-primary rounded-full animate-pulse"></div>
                        <div class="w-1 h-1 bg-brand-accent rounded-full animate-pulse" style="animation-delay: 0.2s"></div>
                        <div class="w-2 h-2 bg-brand-primary rounded-full animate-pulse" style="animation-delay: 0.4s"></div>
                        <div class="w-1 h-1 bg-brand-accent rounded-full animate-pulse" style="animation-delay: 0.6s"></div>
                        <div class="w-3 h-3 bg-brand-primary rounded-full animate-pulse" style="animation-delay: 0.8s"></div>
                    </div>
                </div>
            </div>
        </section>
    </main>



    <!-- Scripts -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, getDocs, query, orderBy, limit } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyASOYZU9OI454p5t9obtZP3mkA6ncawCBw",
            authDomain: "eventify-5e54d.firebaseapp.com",
            projectId: "eventify-5e54d",
            storageBucket: "eventify-5e54d.firebasestorage.app",
            messagingSenderId: "1035518806464",
            appId: "1:1035518806464:web:c5fb9df49b319cd639a025",
            measurementId: "G-0ZC704LYMG"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Check authentication state
        onAuthStateChanged(auth, (user) => {
            const guestElements = document.querySelectorAll('[data-auth="guest"]');
            const requiredElements = document.querySelectorAll('[data-auth="required"]');
            const adminElements = document.querySelectorAll('[data-auth="admin"]');
            const studentElements = document.querySelectorAll('[data-auth="student"]');

            if (user) {
                // User is signed in
                guestElements.forEach(el => el.classList.add('hidden'));
                requiredElements.forEach(el => el.classList.remove('hidden'));
                
                // Check if user is admin
                if (user.email === 'admin@eventify.com') {
                    adminElements.forEach(el => el.classList.remove('hidden'));
                    studentElements.forEach(el => el.classList.add('hidden'));
                } else {
                    adminElements.forEach(el => el.classList.add('hidden'));
                    studentElements.forEach(el => el.classList.remove('hidden'));
                }

                // Update user info
                const userName = document.getElementById('user-name');
                const userAvatar = document.getElementById('user-avatar');
                
                if (userName) userName.textContent = user.displayName || 'User';
                if (userAvatar) {
                    userAvatar.innerHTML = user.displayName ? 
                        `<span class="text-sm font-bold">${user.displayName.charAt(0).toUpperCase()}</span>` :
                        `<svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                        </svg>`;
                }

                // Update CTA buttons
                const signupBtn = document.querySelector('a[href="signup.html"]');
                const loginBtn = document.querySelector('a[href="login.html"]');
                if (signupBtn) signupBtn.href = 'dashboard.html';
                if (loginBtn) loginBtn.href = 'dashboard.html';
                if (signupBtn) signupBtn.textContent = 'Go to Dashboard';
                if (loginBtn) loginBtn.textContent = 'View Profile';
                

            } else {
                // User is signed out
                guestElements.forEach(el => el.classList.remove('hidden'));
                requiredElements.forEach(el => el.classList.add('hidden'));
                adminElements.forEach(el => el.classList.add('hidden'));
                studentElements.forEach(el => el.classList.add('hidden'));
            }
        });

        // Load featured events
        async function loadFeaturedEvents() {
            try {
                console.log('Loading featured events...');
                
                // Clear loading state
                const eventsGrid = document.getElementById('events-grid');
                if (!eventsGrid) {
                    console.error('Events grid element not found');
                    return;
                }
                
                const eventsRef = collection(db, 'events');
                
                // First try to get events without ordering to see if collection exists
                let eventsSnapshot;
                try {
                    const eventsQuery = query(eventsRef, orderBy('startAt', 'asc'), limit(6));
                    eventsSnapshot = await getDocs(eventsQuery);
                    console.log('Events loaded with ordering:', eventsSnapshot.size);
                } catch (orderError) {
                    console.log('Ordering failed, trying without order:', orderError);
                    // If ordering fails, try without it
                    eventsSnapshot = await getDocs(eventsRef);
                    console.log('Events loaded without ordering:', eventsSnapshot.size);
                }
                


                if (eventsSnapshot.empty) {
                    eventsGrid.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-brand-primary/20 to-brand-accent/20 rounded-2xl mb-4">
                                <svg class="w-8 h-8 text-brand-primary" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-brand-text mb-2">No Events Yet</h3>
                            <p class="text-brand-muted mb-6">Be the first to create an exciting university event!</p>
                            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                                <a href="auth-new.html" class="btn btn-primary px-6 py-3 rounded-lg font-medium hover:scale-105 transition-transform duration-300">
                                    Create Account
                                </a>
                                <a href="create-event.html" class="btn btn-ghost px-6 py-3 rounded-lg font-medium hover:scale-105 transition-transform duration-300">
                                    Create Event
                                </a>
                            </div>
                        </div>
                    `;
                    return;
                }

                console.log('Processing events:', eventsSnapshot.docs.length);
                const eventsHTML = eventsSnapshot.docs.map(doc => {
                    const event = doc.data();
                    console.log('Event data:', event);
                    
                    // Handle different date formats
                    let startDate;
                    if (event.startAt && event.startAt.seconds) {
                        startDate = new Date(event.startAt.seconds * 1000);
                    } else if (event.startAt && event.startAt.toDate) {
                        startDate = event.startAt.toDate();
                    } else if (event.startAt) {
                        startDate = new Date(event.startAt);
                    } else {
                        startDate = new Date();
                    }
                    
                    const formattedDate = startDate.toLocaleDateString();
                    const formattedTime = startDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    return `
                        <div class="card p-6 hover:shadow-xl transition-all duration-300 group cursor-pointer" onclick="window.location.href='event.html?id=${doc.id}'">
                            <div class="flex items-start justify-between mb-4">
                                <div class="flex-1">
                                    <h3 class="text-xl font-semibold text-brand-text mb-2 group-hover:text-brand-primary transition-colors">${event.title || 'Untitled Event'}</h3>
                                    <p class="text-brand-muted text-sm mb-4 line-clamp-2">${event.description || 'No description available'}</p>
                                    
                                    <div class="grid grid-cols-2 gap-3 text-sm">
                                        <div class="flex items-center space-x-2">
                                            <svg class="w-4 h-4 text-brand-muted" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
                                            </svg>
                                            <span class="text-brand-text">${formattedDate}</span>
                                        </div>
                                        
                                        <div class="flex items-center space-x-2">
                                            <svg class="w-4 h-4 text-brand-muted" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                                            </svg>
                                            <span class="text-brand-text">${event.location || 'TBD'}</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="ml-4">
                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-500/20 text-green-400">
                                        ${event.status || 'upcoming'}
                                    </span>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between pt-4 border-t border-white/10">
                                <span class="text-sm text-brand-muted">${event.attendeeCount || 0} attending</span>
                                <button class="btn btn-primary text-sm px-4 py-2 rounded-lg font-medium hover:scale-105 transition-transform duration-300">
                                    View Details
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');

                eventsGrid.innerHTML = eventsHTML;
                console.log('Events displayed successfully');
                
            } catch (error) {
                console.error('Error loading featured events:', error);
                const eventsGrid = document.getElementById('events-grid');
                if (eventsGrid) {
                    eventsGrid.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="text-red-400 mb-4">Failed to load events. Please refresh the page.</div>
                            <div class="text-sm text-brand-muted">Error: ${error.message}</div>
                            <button onclick="loadFeaturedEvents()" class="btn btn-secondary mt-4 px-6 py-2 rounded-lg font-medium hover:scale-105 transition-transform duration-300">
                                Try Again
                            </button>
                            <div class="mt-4 text-xs text-brand-muted">
                                <p>This might be due to:</p>
                                <ul class="list-disc list-inside mt-2 space-y-1">
                                    <li>No events in the database yet</li>
                                    <li>Network connectivity issues</li>
                                    <li>Database temporarily unavailable</li>
                                </ul>
                            </div>
                        </div>
                    `;
                }
            }
        }

        // Logout functionality
        document.addEventListener('click', function(event) {
            if (event.target.id === 'logout-btn') {
                auth.signOut().then(() => {
                    window.location.href = 'index.html';
                }).catch((error) => {
                    console.error('Logout error:', error);
                });
            }
        });

        // Theme toggle
        document.getElementById('theme-toggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });

        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', () => {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // Load events when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Load events for everyone (public access)
            loadFeaturedEvents();
        });

        console.log('Home page script loaded');
    </script>

    <!-- Floating Chatbot Button -->
    <div id="chatbot-container" class="fixed bottom-6 right-6 z-50">
        <!-- Chatbot Button -->
        <button id="chatbot-toggle" class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full shadow-2xl hover:shadow-3xl hover:scale-110 transition-all duration-300 flex items-center justify-center group">
            <svg id="chatbot-icon" class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"/>
                <path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"/>
            </svg>
            <svg id="close-icon" class="w-8 h-8 text-white hidden" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
            </svg>
        </button>

        <!-- Chatbot Modal -->
        <div id="chatbot-modal" class="hidden absolute bottom-20 right-0 w-96 bg-gray-900 border border-white/10 rounded-2xl shadow-2xl backdrop-blur-sm">
            <!-- Header -->
            <div class="flex items-center justify-between p-4 border-b border-white/10">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"/>
                            <path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-white">Eventify Assistant</h3>
                        <p class="text-sm text-gray-300">Ask me anything about events!</p>
                    </div>
                </div>
            </div>

            <!-- Chat Messages -->
            <div id="chat-messages" class="h-96 overflow-y-auto p-4 space-y-4">
                <!-- Welcome Message -->
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"/>
                            <path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <div class="bg-gray-800/50 rounded-2xl p-3 max-w-xs">
                            <p class="text-sm text-white">Hi! I'm your Eventify assistant. I can help you with:</p>
                            <ul class="text-xs text-gray-300 mt-2 space-y-1">
                                <li>• Event registration</li>
                                <li>• Cancellation policies</li>
                                <li>• Event details</li>
                                <li>• General questions</li>
                            </ul>
                            <p class="text-sm text-white mt-2">What would you like to know?</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="p-4 border-t border-white/10">
                <div class="flex space-x-3">
                    <input type="text" id="chat-input" placeholder="Type your question..." class="flex-1 px-4 py-2 bg-gray-800 border border-white/10 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50">
                    <button id="send-message" class="px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:scale-105 transition-transform duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.25A1 1 0 009 15.25l1.25 5a1 1 0 001.409 1.169l7-14a1 1 0 00-1.788-1.409L13.25 9a1 1 0 00-1.409-1.169l-1.25-5z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chatbot Script -->
    <script>
        // Gemini API Configuration
        const GEMINI_API_KEY = 'YOUR_GEMINI_API_KEY_HERE'; // Replace with your actual API key
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent';

        // Chatbot functionality
        class EventifyChatbot {
            constructor() {
                this.isOpen = false;
                this.messages = [];
                this.initializeEventListeners();
            }

            initializeEventListeners() {
                const toggleBtn = document.getElementById('chatbot-toggle');
                const modal = document.getElementById('chatbot-modal');
                const input = document.getElementById('chat-input');
                const sendBtn = document.getElementById('send-message');

                toggleBtn.addEventListener('click', () => this.toggleChat());
                sendBtn.addEventListener('click', () => this.sendMessage());
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendMessage();
                });

                // Close on outside click
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('#chatbot-container')) {
                        this.closeChat();
                    }
                });
            }

            toggleChat() {
                this.isOpen = !this.isOpen;
                const modal = document.getElementById('chatbot-modal');
                const icon = document.getElementById('chatbot-icon');
                const closeIcon = document.getElementById('close-icon');

                if (this.isOpen) {
                    modal.classList.remove('hidden');
                    icon.classList.add('hidden');
                    closeIcon.classList.remove('hidden');
                    document.getElementById('chat-input').focus();
                } else {
                    this.closeChat();
                }
            }

            closeChat() {
                this.isOpen = false;
                const modal = document.getElementById('chatbot-modal');
                const icon = document.getElementById('chatbot-icon');
                const closeIcon = document.getElementById('close-icon');

                modal.classList.add('hidden');
                icon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            }

            async sendMessage() {
                const input = document.getElementById('chat-input');
                const message = input.value.trim();
                
                if (!message) return;

                // Add user message to chat
                this.addMessage(message, 'user');
                input.value = '';

                // Show typing indicator
                this.showTypingIndicator();

                try {
                    // Get response from Gemini API
                    const response = await this.getGeminiResponse(message);
                    this.hideTypingIndicator();
                    this.addMessage(response, 'bot');
                } catch (error) {
                    this.hideTypingIndicator();
                    this.addMessage('Sorry, I encountered an error. Please try again.', 'bot');
                    console.error('Chatbot error:', error);
                }
            }

            addMessage(content, sender) {
                const messagesContainer = document.getElementById('chat-messages');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'flex items-start space-x-3';

                if (sender === 'user') {
                    messageDiv.innerHTML = `
                        <div class="flex-1"></div>
                        <div class="flex-1">
                            <div class="bg-blue-500/20 border border-blue-500/30 rounded-2xl p-3 max-w-xs ml-auto">
                                <p class="text-sm text-white">${this.escapeHtml(content)}</p>
                            </div>
                        </div>
                        <div class="w-8 h-8 bg-gradient-to-br from-purple-600 to-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
                            <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    `;
                } else {
                    messageDiv.innerHTML = `
                        <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                            <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"/>
                                <path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"/>
                            </svg>
                        </div>
                        <div class="flex-1">
                            <div class="bg-gray-800/50 rounded-2xl p-3 max-w-xs">
                                <p class="text-sm text-white">${this.escapeHtml(content)}</p>
                            </div>
                        </div>
                    `;
                }

                messagesContainer.appendChild(messageDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            showTypingIndicator() {
                const messagesContainer = document.getElementById('chat-messages');
                const typingDiv = document.createElement('div');
                typingDiv.id = 'typing-indicator';
                typingDiv.className = 'flex items-start space-x-3';
                typingDiv.innerHTML = `
                                    <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                    <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"/>
                        <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"/>
                    </svg>
                </div>
                <div class="flex-1">
                    <div class="bg-gray-800/50 rounded-2xl p-3 max-w-xs">
                        <div class="flex space-x-1">
                            <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce"></div>
                            <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                            <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        </div>
                    </div>
                </div>
                `;
                messagesContainer.appendChild(typingDiv);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }

            hideTypingIndicator() {
                const typingIndicator = document.getElementById('typing-indicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }

            async getGeminiResponse(message) {
                if (!GEMINI_API_KEY || GEMINI_API_KEY === 'YOUR_GEMINI_API_KEY_HERE') {
                    // Fallback responses if no API key
                    return this.getFallbackResponse(message);
                }

                try {
                    const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: `You are Eventify, a helpful assistant for a university club event management platform. Answer questions about events, registration, and general inquiries. Keep responses concise and helpful. User question: ${message}`
                                }]
                            }]
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const data = await response.json();
                    
                    if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                        return data.candidates[0].content.parts[0].text;
                    } else {
                        throw new Error('Invalid response format from Gemini API');
                    }
                } catch (error) {
                    console.error('Gemini API error:', error);
                    // Fallback to rule-based responses
                    return this.getFallbackResponse(message);
                }
            }

            getFallbackResponse(message) {
                const lowerMessage = message.toLowerCase();
                
                // Rule-based responses for common questions
                if (lowerMessage.includes('register') || lowerMessage.includes('sign up')) {
                    return "To register for an event, simply click on the event you're interested in and look for the 'Register' or 'Sign Up' button. You'll need to be logged in to your Eventify account.";
                } else if (lowerMessage.includes('cancel') || lowerMessage.includes('refund')) {
                    return "Event cancellation policies vary by event. Generally, you can cancel your registration up to 24 hours before the event starts. Check the specific event details for cancellation policies.";
                } else if (lowerMessage.includes('event') && lowerMessage.includes('detail')) {
                    return "Event details include date, time, location, description, and attendee count. Click on any event card to view full details and registration options.";
                } else if (lowerMessage.includes('login') || lowerMessage.includes('account')) {
                    return "You can log in using the 'Login' button in the top navigation. If you don't have an account, use the 'Sign Up' button to create one.";
                } else if (lowerMessage.includes('help') || lowerMessage.includes('support')) {
                    return "I'm here to help! You can ask me about event registration, cancellation policies, event details, or any other questions about using Eventify.";
                } else {
                    return "I'm not sure about that specific question. Try asking about event registration, cancellation policies, or general event information. You can also check our FAQ page for more detailed answers.";
                }
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // Initialize chatbot when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new EventifyChatbot();
        });
    </script>
</body>
</html>
