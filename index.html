<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eventify - University Club Event Management Platform</title>
    <meta name="description" content="Discover and register for university club events. Join exciting activities, meet new people, and enhance your campus experience.">
    
    <!-- Tailwind CSS -->
    <link href="./styles/output.css" rel="stylesheet">
    
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    

    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="./assets/img/logo.svg">
</head>
<body class="bg-brand-surface text-brand-text font-body min-h-screen">
    <!-- Navigation -->
    <nav class="nav-blur sticky top-0 z-40">
        <div class="container-custom">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-brand-primary to-brand-accent rounded-xl flex items-center justify-center glow-effect">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <span class="text-xl font-bold text-gradient">Eventify</span>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html" class="text-brand-text hover:text-brand-primary transition-colors font-medium">Home</a>
                    <a href="events.html" class="text-brand-muted hover:text-brand-text transition-colors">Events</a>
                    <a href="#ai-faq-chat" class="text-brand-muted hover:text-brand-text transition-colors">AI FAQ Chat</a>
                    
                    <!-- Guest Navigation -->
                    <div data-auth="guest" class="flex items-center space-x-4">
                        <a href="auth-new.html" class="btn btn-ghost">Login</a>
                        <a href="auth-new.html#signup" class="btn btn-primary">Sign Up</a>
                    </div>

                    <!-- Authenticated Navigation -->
                    <div data-auth="required" class="hidden flex items-center space-x-4">
                        <a href="dashboard.html" data-auth="student" class="text-brand-muted hover:text-brand-text transition-colors">Dashboard</a>
                        <a href="admin-dashboard.html" data-auth="admin" class="text-brand-muted hover:text-brand-text transition-colors">Admin</a>
                        
                        <!-- User Menu -->
                        <div class="relative" id="user-menu">
                            <button class="flex items-center space-x-2 text-brand-text hover:text-brand-primary transition-colors">
                                <div class="w-8 h-8 bg-gradient-to-br from-brand-primary to-brand-accent rounded-full flex items-center justify-center" id="user-avatar">
                                    <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <span id="user-name" class="font-medium">User</span>
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414L10 11.414l-3.293 3.293a1 1 0 01-1.414-1.414L8.586 10 5.293 6.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                            
                            <!-- Dropdown Menu -->
                            <div class="absolute right-0 mt-2 w-48 glass-effect rounded-2xl shadow-2xl opacity-0 invisible transition-all duration-200">
                                <div class="py-2">
                                    <a href="profile.html" class="block px-4 py-2 text-sm text-brand-text hover:bg-white/5 transition-colors">Profile</a>
                                    <a href="settings.html" class="block px-4 py-2 text-sm text-brand-text hover:bg-white/5 transition-colors">Settings</a>
                                    <hr class="border-white/10 my-2">
                                    <button id="logout-btn" class="block w-full text-left px-4 py-2 text-sm text-brand-danger hover:bg-white/5 transition-colors">Logout</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Theme Toggle -->
                <button id="theme-toggle" class="p-2 text-brand-muted hover:text-brand-text transition-colors rounded-xl hover:bg-white/5">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"/>
                    </svg>
                </button>

                <!-- Mobile Menu Button -->
                <button id="mobile-menu-button" class="md:hidden p-2 text-brand-muted hover:text-brand-text transition-colors rounded-xl hover:bg-white/5">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
                    </svg>
                </button>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden pb-4 border-t border-white/10">
                <div class="flex flex-col space-y-4 pt-4">
                    <a href="index.html" class="text-brand-text hover:text-brand-primary transition-colors font-medium">Home</a>
                    <a href="events.html" class="text-brand-muted hover:text-brand-text transition-colors">Events</a>
                    <a href="#ai-faq-chat" class="text-brand-muted hover:text-brand-text transition-colors">AI FAQ Chat</a>
                    
                    <!-- Guest Mobile Navigation -->
                    <div data-auth="guest" class="flex flex-col space-y-2">
                        <a href="auth-new.html" class="btn btn-ghost w-full justify-center">Login</a>
                        <a href="auth-new.html#signup" class="btn btn-primary w-full justify-center">Sign Up</a>
                    </div>

                    <!-- Authenticated Mobile Navigation -->
                    <div data-auth="required" class="hidden flex flex-col space-y-2">
                        <a href="dashboard.html" data-auth="student" class="text-brand-muted hover:text-brand-text transition-colors">Dashboard</a>
                        <a href="admin-dashboard.html" data-auth="admin" class="text-brand-muted hover:text-brand-text transition-colors">Admin</a>
                        <a href="profile.html" class="text-brand-muted hover:text-brand-text transition-colors">Profile</a>
                        <a href="settings.html" class="text-brand-muted hover:text-brand-text transition-colors">Settings</a>
                        <button id="mobile-logout-btn" class="text-left text-brand-danger hover:text-brand-danger/80 transition-colors">Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="floating-elements">
        <!-- Hero Section -->
        <section class="section-padding relative overflow-hidden">
            <div class="hero-gradient absolute inset-0"></div>
            <div class="container-custom relative z-10">
                <div class="text-center max-w-5xl mx-auto animate-fade-in">
                    <h1 class="heading-large mb-8">
                        Discover & Join
                        <span class="text-gradient">University Club Events</span>
                    </h1>
                    <p class="text-lead mb-12 max-w-3xl mx-auto">
                        Connect with your campus community through exciting events, workshops, and activities organized by university clubs.
                    </p>

                    <!-- Search Bar -->
                    <div class="max-w-2xl mx-auto mb-12">
                        <div class="relative">
                            <input 
                                type="text" 
                                placeholder="Search events, clubs, or categories..." 
                                class="w-full px-6 py-4 pl-14 text-lg bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl text-brand-text placeholder-brand-muted focus:outline-none focus:ring-2 focus:ring-brand-primary focus:border-transparent transition-all"
                                id="hero-search"
                            >
                            <svg class="absolute left-5 top-1/2 transform -translate-y-1/2 w-6 h-6 text-brand-muted" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                            </svg>
                            <button class="absolute right-3 top-1/2 transform -translate-y-1/2 btn btn-primary px-6 py-2" id="hero-search-btn">
                                Search
                            </button>
                        </div>
                    </div>

                    <div class="flex justify-center mb-16">
                        <a href="events.html" class="btn btn-primary text-lg px-10 py-5 glow-effect">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            Browse Events
                        </a>
                    </div>

                    <!-- Stats -->
                    <div class="grid grid-cols-3 gap-8 max-w-md mx-auto text-center mb-16">
                        <div class="animate-fade-in">
                            <div class="text-3xl font-bold text-brand-primary mb-1" id="total-events-stat">500+</div>
                            <div class="text-sm text-brand-muted">Events</div>
                        </div>
                        <div class="animate-fade-in" style="animation-delay: 0.1s">
                            <div class="text-3xl font-bold text-brand-accent mb-1" id="total-clubs-stat">50+</div>
                            <div class="text-sm text-brand-muted">Clubs</div>
                        </div>
                        <div class="animate-fade-in" style="animation-delay: 0.2s">
                            <div class="text-3xl font-bold text-brand-success mb-1" id="total-students-stat">2000+</div>
                            <div class="text-sm text-brand-muted">Students</div>
                        </div>
                    </div>

                    <div class="divider"></div>
                </div>
            </div>
        </section>

        <!-- Featured Events Section -->
        <section class="section-padding relative overflow-hidden">
            <!-- Background Elements -->
            <div class="absolute inset-0 bg-gradient-to-br from-brand-primary/5 via-transparent to-brand-accent/5"></div>
            <div class="absolute top-20 left-10 w-72 h-72 bg-brand-primary/10 rounded-full filter blur-3xl animate-float"></div>
            <div class="absolute bottom-20 right-10 w-96 h-96 bg-brand-accent/10 rounded-full filter blur-3xl animate-float-slow"></div>
            
            <div class="container-custom relative z-10">
                <div class="text-center mb-16 animate-slide-up">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-brand-primary/20 to-brand-accent/20 rounded-3xl mb-6">
                        <svg class="w-8 h-8 text-brand-primary" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <h2 class="heading-medium mb-6">
                        Upcoming Events
                    </h2>
                    <p class="text-lead max-w-2xl mx-auto">
                        Don't miss out on these exciting opportunities to connect with your campus community
                    </p>
                </div>

                <!-- Events Grid -->
                <div id="events-grid" class="grid-responsive">
                    <!-- Loading State -->
                    <div class="col-span-full text-center py-12">
                        <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-brand-primary/20 to-brand-accent/20 rounded-2xl mb-4 animate-pulse">
                            <svg class="w-8 h-8 text-brand-primary" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h3 class="text-lg font-semibold text-brand-text mb-2">Loading Events...</h3>
                        <p class="text-brand-muted">Please wait while we fetch the latest events</p>
                    </div>
                </div>

                <!-- View All Button -->
                <div class="text-center mt-16">
                    <a href="events.html" class="btn btn-primary px-12 py-5 text-lg glow-effect hover:scale-105 transition-transform duration-300">
                        <svg class="w-5 h-5 mr-3" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        View All Events
                    </a>
                </div>
            </div>
        </section>

        <!-- AI FAQ Chat Section -->
        <section id="ai-faq-chat" class="section-padding relative overflow-hidden">
            <!-- Background Elements -->
            <div class="absolute inset-0 bg-gradient-to-br from-brand-primary/5 via-transparent to-brand-accent/5"></div>
            <div class="absolute top-20 right-10 w-72 h-72 bg-brand-accent/10 rounded-full filter blur-3xl animate-float"></div>
            <div class="absolute bottom-20 left-10 w-96 h-96 bg-brand-primary/10 rounded-full filter blur-3xl animate-float-slow"></div>
            
            <div class="container-custom relative z-10">
                <div class="text-center mb-16 animate-slide-up">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-brand-accent/20 to-brand-primary/20 rounded-3xl mb-6">
                        <svg class="w-8 h-8 text-brand-accent" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <h2 class="heading-medium mb-6">
                        AI-Powered FAQ Assistant
                    </h2>
                    <p class="text-lead max-w-2xl mx-auto">
                        Get instant answers to any questions about events, the platform, or university activities
                    </p>
                </div>

                <!-- AI Chat Interface -->
                <div class="max-w-4xl mx-auto">
                    <div class="card p-6 bg-white/5 backdrop-blur-sm border border-white/10">
                        <!-- Chat Header -->
                        <div class="flex items-center space-x-3 mb-6 pb-4 border-b border-white/10">
                            <div class="w-10 h-10 bg-gradient-to-br from-brand-accent to-brand-primary rounded-full flex items-center justify-center">
                                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                                </svg>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-brand-text">Eventify AI Assistant</h3>
                                <p class="text-sm text-brand-muted">Ask me anything about events, the platform, or university activities</p>
                            </div>
                        </div>

                        <!-- Chat Messages -->
                        <div id="chat-messages" class="space-y-4 mb-6 max-h-96 overflow-y-auto">
                            <!-- Welcome Message -->
                            <div class="flex items-start space-x-3">
                                <div class="w-8 h-8 bg-gradient-to-br from-brand-accent to-brand-primary rounded-full flex items-center justify-center flex-shrink-0">
                                    <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <div class="bg-brand-primary/10 rounded-2xl rounded-tl-md px-4 py-3 max-w-xs">
                                    <p class="text-brand-text text-sm">
                                        ðŸ‘‹ Hi! I'm your AI assistant. I can help you with:
                                    </p>
                                    <ul class="text-brand-muted text-xs mt-2 space-y-1">
                                        <li>â€¢ Event information and registration</li>
                                        <li>â€¢ Platform features and navigation</li>
                                        <li>â€¢ University club activities</li>
                                        <li>â€¢ General questions about Eventify</li>
                                    </ul>
                                    <p class="text-brand-text text-sm mt-2">
                                        What would you like to know?
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Chat Input -->
                        <div class="flex space-x-3">
                            <div class="flex-1 relative">
                                <input 
                                    type="text" 
                                    id="chat-input"
                                    placeholder="Ask me anything about events, the platform, or university activities..." 
                                    class="w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-2xl text-brand-text placeholder-brand-muted focus:outline-none focus:ring-2 focus:ring-brand-accent focus:border-transparent transition-all"
                                >
                                <div id="typing-indicator" class="hidden absolute right-3 top-1/2 transform -translate-y-1/2">
                                    <div class="flex space-x-1">
                                        <div class="w-2 h-2 bg-brand-accent rounded-full animate-bounce"></div>
                                        <div class="w-2 h-2 bg-brand-accent rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                        <div class="w-2 h-2 bg-brand-accent rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                                    </div>
                                </div>
                            </div>
                            <button 
                                id="send-btn"
                                class="btn btn-primary px-6 py-3 rounded-2xl hover:scale-105 transition-transform duration-300"
                                onclick="sendMessage()"
                            >
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"/>
                                </svg>
                            </button>
                        </div>

                        <!-- Quick Questions -->
                        <div class="mt-6 pt-4 border-t border-white/10">
                            <p class="text-sm text-brand-muted mb-3">Quick questions:</p>
                            <div class="flex flex-wrap gap-2">
                                <button 
                                    onclick="askQuickQuestion('How do I register for an event?')"
                                    class="px-3 py-2 text-xs bg-brand-accent/20 text-brand-accent rounded-full hover:bg-brand-accent/30 transition-colors"
                                >
                                    How do I register for an event?
                                </button>
                                <button 
                                    onclick="askQuickQuestion('What types of events are available?')"
                                    class="px-3 py-2 text-xs bg-brand-primary/20 text-brand-primary rounded-full hover:bg-brand-primary/30 transition-colors"
                                >
                                    What types of events are available?
                                </button>
                                <button 
                                    onclick="askQuickQuestion('How do I create a club event?')"
                                    class="px-3 py-2 text-xs bg-brand-accent/20 text-brand-accent rounded-full hover:bg-brand-accent/30 transition-colors"
                                >
                                    How do I create a club event?
                                </button>
                                <button 
                                    onclick="askQuickQuestion('What are the platform features?')"
                                    class="px-3 py-2 text-xs bg-brand-primary/20 text-brand-primary rounded-full hover:bg-brand-primary/30 transition-colors"
                                >
                                    What are the platform features?
                                </button>
                            </div>
                        </div>

                        <!-- Debug Panel (Development) -->
                        <div class="mt-6 pt-4 border-t border-white/10">
                            <details class="text-sm">
                                <summary class="text-brand-muted cursor-pointer hover:text-brand-text transition-colors">
                                    ðŸ”§ Debug Info (Click to expand)
                                </summary>
                                <div class="mt-3 space-y-2 text-xs">
                                    <div class="bg-white/5 rounded-lg p-3">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-brand-muted">API Status:</span>
                                            <span id="api-status" class="px-2 py-1 rounded text-white">Checking...</span>
                                        </div>
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-brand-muted">Model:</span>
                                            <span class="text-brand-text">gemini-2.0-flash</span>
                                        </div>
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-brand-muted">Chat History:</span>
                                            <span id="chat-history-count" class="text-brand-text">0 messages</span>
                                        </div>
                                        <button 
                                            onclick="clearChatHistory()"
                                            class="px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs hover:bg-red-500/30 transition-colors"
                                        >
                                            Clear Chat
                                        </button>
                                    </div>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="section-padding relative overflow-hidden">
            <!-- Background Elements -->
            <div class="absolute inset-0 bg-gradient-to-br from-brand-accent/5 via-transparent to-brand-primary/5"></div>
            <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-full h-1 bg-gradient-to-r from-transparent via-brand-primary/30 to-transparent"></div>
            
            <div class="container-custom relative z-10">
                <div class="max-w-4xl mx-auto text-center">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-brand-accent/20 to-brand-primary/20 rounded-3xl mb-8 animate-pulse-slow">
                        <svg class="w-10 h-10 text-brand-accent" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    
                    <h2 class="heading-medium mb-6">
                        Ready to Get Started?
                    </h2>
                    <p class="text-lead mb-12 max-w-2xl mx-auto">
                        Join thousands of students already using Eventify to discover amazing campus events
                    </p>
                    
                    <div class="flex flex-col sm:flex-row gap-6 justify-center items-center">
                        <a href="auth-new.html#signup" class="btn btn-primary text-lg px-12 py-5 glow-effect hover:scale-105 transition-transform duration-300">
                            <svg class="w-5 h-5 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                            </svg>
                            Create Your Account
                        </a>
                        <a href="auth-new.html" class="btn btn-ghost text-lg px-12 py-5 hover:scale-105 transition-transform duration-300">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="false"/>
                            </svg>
                            Sign In
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>



    <!-- Scripts -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, getDocs, query, orderBy, limit } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyASOYZU9OI454p5t9obtZP3mkA6ncawCBw",
            authDomain: "eventify-5e54d.firebaseapp.com",
            projectId: "eventify-5e54d",
            storageBucket: "eventify-5e54d.firebasestorage.app",
            messagingSenderId: "1035518806464",
            appId: "1:1035518806464:web:c5fb9df49b319cd639a025",
            measurementId: "G-0ZC704LYMG"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Check authentication state
        onAuthStateChanged(auth, (user) => {
            const guestElements = document.querySelectorAll('[data-auth="guest"]');
            const requiredElements = document.querySelectorAll('[data-auth="required"]');
            const adminElements = document.querySelectorAll('[data-auth="admin"]');
            const studentElements = document.querySelectorAll('[data-auth="student"]');

            if (user) {
                // User is signed in
                guestElements.forEach(el => el.classList.add('hidden'));
                requiredElements.forEach(el => el.classList.remove('hidden'));
                
                // Check if user is admin
                if (user.email === 'admin@eventify.com') {
                    adminElements.forEach(el => el.classList.remove('hidden'));
                    studentElements.forEach(el => el.classList.add('hidden'));
                } else {
                    adminElements.forEach(el => el.classList.add('hidden'));
                    studentElements.forEach(el => el.classList.remove('hidden'));
                }

                // Update user info
                const userName = document.getElementById('user-name');
                const userAvatar = document.getElementById('user-avatar');
                
                if (userName) userName.textContent = user.displayName || 'User';
                if (userAvatar) {
                    userAvatar.innerHTML = user.displayName ? 
                        `<span class="text-sm font-bold">${user.displayName.charAt(0).toUpperCase()}</span>` :
                        `<svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                        </svg>`;
                }

                // Update CTA buttons
                const signupBtn = document.querySelector('a[href="signup.html"]');
                const loginBtn = document.querySelector('a[href="login.html"]');
                if (signupBtn) signupBtn.href = 'dashboard.html';
                if (loginBtn) loginBtn.href = 'dashboard.html';
                if (signupBtn) signupBtn.textContent = 'Go to Dashboard';
                if (loginBtn) loginBtn.textContent = 'View Profile';
                

            } else {
                // User is signed out
                guestElements.forEach(el => el.classList.remove('hidden'));
                requiredElements.forEach(el => el.classList.add('hidden'));
                adminElements.forEach(el => el.classList.add('hidden'));
                studentElements.forEach(el => el.classList.add('hidden'));
            }
        });

        // Load featured events
        async function loadFeaturedEvents() {
            try {
                console.log('Loading featured events...');
                
                // Clear loading state
                const eventsGrid = document.getElementById('events-grid');
                if (!eventsGrid) {
                    console.error('Events grid element not found');
                    return;
                }
                
                const eventsRef = collection(db, 'events');
                
                // First try to get events without ordering to see if collection exists
                let eventsSnapshot;
                try {
                    const eventsQuery = query(eventsRef, orderBy('startAt', 'asc'), limit(6));
                    eventsSnapshot = await getDocs(eventsQuery);
                    console.log('Events loaded with ordering:', eventsSnapshot.size);
                } catch (orderError) {
                    console.log('Ordering failed, trying without order:', orderError);
                    // If ordering fails, try without it
                    eventsSnapshot = await getDocs(eventsRef);
                    console.log('Events loaded without ordering:', eventsSnapshot.size);
                }
                


                if (eventsSnapshot.empty) {
                    eventsGrid.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-brand-primary/20 to-brand-accent/20 rounded-2xl mb-4">
                                <svg class="w-8 h-8 text-brand-primary" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-brand-text mb-2">No Events Yet</h3>
                            <p class="text-brand-muted mb-6">Be the first to create an exciting university event!</p>
                            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                                <a href="auth-new.html" class="btn btn-primary px-6 py-3 rounded-lg font-medium hover:scale-105 transition-transform duration-300">
                                    Create Account
                                </a>
                                <a href="create-event.html" class="btn btn-ghost px-6 py-3 rounded-lg font-medium hover:scale-105 transition-transform duration-300">
                                    Create Event
                                </a>
                            </div>
                        </div>
                    `;
                    return;
                }

                console.log('Processing events:', eventsSnapshot.docs.length);
                const eventsHTML = eventsSnapshot.docs.map(doc => {
                    const event = doc.data();
                    console.log('Event data:', event);
                    
                    // Handle different date formats
                    let startDate;
                    if (event.startAt && event.startAt.seconds) {
                        startDate = new Date(event.startAt.seconds * 1000);
                    } else if (event.startAt && event.startAt.toDate) {
                        startDate = event.startAt.toDate();
                    } else if (event.startAt) {
                        startDate = new Date(event.startAt);
                    } else {
                        startDate = new Date();
                    }
                    
                    const formattedDate = startDate.toLocaleDateString();
                    const formattedTime = startDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    return `
                        <div class="card p-6 hover:shadow-xl transition-all duration-300 group cursor-pointer" onclick="window.location.href='event.html?id=${doc.id}'">
                            <div class="flex items-start justify-between mb-4">
                                <div class="flex-1">
                                    <h3 class="text-xl font-semibold text-brand-text mb-2 group-hover:text-brand-primary transition-colors">${event.title || 'Untitled Event'}</h3>
                                    <p class="text-brand-muted text-sm mb-4 line-clamp-2">${event.description || 'No description available'}</p>
                                    
                                    <div class="grid grid-cols-2 gap-3 text-sm">
                                        <div class="flex items-center space-x-2">
                                            <svg class="w-4 h-4 text-brand-muted" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
                                            </svg>
                                            <span class="text-brand-text">${formattedDate}</span>
                                        </div>
                                        
                                        <div class="flex items-center space-x-2">
                                            <svg class="w-4 h-4 text-brand-muted" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                                            </svg>
                                            <span class="text-brand-text">${event.location || 'TBD'}</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="ml-4">
                                    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-500/20 text-green-400">
                                        ${event.status || 'upcoming'}
                                    </span>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between pt-4 border-t border-white/10">
                                <span class="text-sm text-brand-muted">${event.attendeeCount || 0} attending</span>
                                <button class="btn btn-primary text-sm px-4 py-2 rounded-lg font-medium hover:scale-105 transition-transform duration-300">
                                    View Details
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');

                eventsGrid.innerHTML = eventsHTML;
                console.log('Events displayed successfully');
                
            } catch (error) {
                console.error('Error loading featured events:', error);
                const eventsGrid = document.getElementById('events-grid');
                if (eventsGrid) {
                    eventsGrid.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <div class="text-red-400 mb-4">Failed to load events. Please refresh the page.</div>
                            <div class="text-sm text-brand-muted">Error: ${error.message}</div>
                            <button onclick="loadFeaturedEvents()" class="btn btn-secondary mt-4 px-6 py-2 rounded-lg font-medium hover:scale-105 transition-transform duration-300">
                                Try Again
                            </button>
                            <div class="mt-4 text-xs text-brand-muted">
                                <p>This might be due to:</p>
                                <ul class="list-disc list-inside mt-2 space-y-1">
                                    <li>No events in the database yet</li>
                                    <li>Network connectivity issues</li>
                                    <li>Database temporarily unavailable</li>
                                </ul>
                            </div>
                        </div>
                    `;
                }
            }
        }

        // Logout functionality
        document.addEventListener('click', function(event) {
            if (event.target.id === 'logout-btn') {
                auth.signOut().then(() => {
                    window.location.href = 'index.html';
                }).catch((error) => {
                    console.error('Logout error:', error);
                });
            }
        });

        // Theme toggle
        document.getElementById('theme-toggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });

        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', () => {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // Load events when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Load events for everyone (public access)
            loadFeaturedEvents();
        });

        console.log('Home page script loaded');

        // AI Chat Functionality with Gemini API
        let chatHistory = [];

        // Gemini API Configuration
        const GEMINI_API_KEY = 'AIzaSyCrCZ_FlcKv83pSiLI8l9po6VLGgXXzMNY';
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent';

        // Send message function
        window.sendMessage = async function() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to chat
            addMessageToChat('user', message);
            input.value = '';
            
            // Show typing indicator
            showTypingIndicator(true);
            
            try {
                // Get AI response
                const response = await getAIResponse(message);
                addMessageToChat('ai', response);
            } catch (error) {
                console.error('AI response error:', error);
                addMessageToChat('ai', 'Sorry, I encountered an error. Please try again or check your internet connection.');
            }
            
            // Hide typing indicator
            showTypingIndicator(false);
        };

        // Add message to chat
        function addMessageToChat(sender, message) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex items-start space-x-3';
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 bg-gradient-to-br from-brand-primary to-brand-accent rounded-full flex items-center justify-center flex-shrink-0">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="bg-brand-primary/20 rounded-2xl rounded-tr-md px-4 py-3 max-w-xs ml-auto">
                        <p class="text-brand-text text-sm">${escapeHtml(message)}</p>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 bg-gradient-to-br from-brand-accent to-brand-primary rounded-full flex items-center justify-center flex-shrink-0">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="bg-brand-accent/10 rounded-2xl rounded-tl-md px-4 py-3 max-w-xs">
                        <p class="text-brand-text text-sm">${escapeHtml(message)}</p>
                    </div>
                `;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Add to chat history
            chatHistory.push({ sender, message, timestamp: new Date() });
            
            // Update debug panel
            updateDebugPanel('chat-history-count', `${chatHistory.length} messages`, 'bg-blue-500');
        }

        // Get AI response from Gemini API
        async function getAIResponse(userMessage) {
            if (!GEMINI_API_KEY) {
                return getFallbackResponse(userMessage);
            }

            try {
                // Build conversation context with chat history
                const conversationContext = buildConversationContext(userMessage);
                
                const requestBody = {
                    contents: conversationContext,
                    generationConfig: {
                        temperature: 0.7,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 1024,
                    },
                    safetySettings: [
                        {
                            category: "HARM_CATEGORY_HARASSMENT",
                            threshold: "BLOCK_MEDIUM_AND_ABOVE"
                        },
                        {
                            category: "HARM_CATEGORY_HATE_SPEECH",
                            threshold: "BLOCK_MEDIUM_AND_ABOVE"
                        },
                        {
                            category: "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                            threshold: "BLOCK_MEDIUM_AND_ABOVE"
                        },
                        {
                            category: "HARM_CATEGORY_DANGEROUS_CONTENT",
                            threshold: "BLOCK_MEDIUM_AND_ABOVE"
                        }
                    ]
                };

                console.log('Sending request to Gemini API:', requestBody);

                const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-goog-api-key': GEMINI_API_KEY
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('API Response Error:', response.status, errorText);
                    throw new Error(`HTTP error! status: ${response.status}: ${errorText}`);
                }

                const data = await response.json();
                console.log('Gemini API Response:', data);
                
                if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                    const aiResponse = data.candidates[0].content.parts[0].text;
                    
                    // Add to chat history
                    chatHistory.push({ 
                        sender: 'ai', 
                        message: aiResponse, 
                        timestamp: new Date() 
                    });
                    
                    return aiResponse;
                } else {
                    console.error('Unexpected API response format:', data);
                    throw new Error('Invalid response format from Gemini API');
                }
                
            } catch (error) {
                console.error('Gemini API error:', error);
                return getFallbackResponse(userMessage);
            }
        }

        // Build conversation context with chat history
        function buildConversationContext(userMessage) {
            const systemPrompt = {
                role: "user",
                parts: [{
                    text: `You are EventifyAI, an intelligent AI assistant for Eventify - a university club event management platform. 

Your role is to help users with:
- Event discovery, registration, and management
- Platform features and navigation
- University club activities and information
- General questions about the platform

Key platform features:
- Event browsing and search
- User registration and profiles
- Event creation and management
- Attendance tracking
- Certificate generation
- Admin dashboard for clubs

Be helpful, friendly, and informative. Keep responses concise but comprehensive. Always provide actionable advice when possible.

Current user question: ${userMessage}

Previous conversation context: ${chatHistory.length > 0 ? chatHistory.slice(-5).map(msg => `${msg.sender}: ${msg.message}`).join('\n') : 'No previous context'}

Please provide a helpful, accurate response:`
                }]
            };

            return [systemPrompt];
        }

        // Fallback response when API is not available
        function getFallbackResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            if (message.includes('register') || message.includes('sign up') || message.includes('join')) {
                return "To register for events, you'll need to create an account first. Click the 'Sign Up' button in the navigation, then you can browse and register for events from your dashboard.";
            } else if (message.includes('event') && message.includes('type')) {
                return "Eventify supports various types of events including academic conferences, workshops, social gatherings, cultural festivals, sports competitions, and club meetings. You can filter events by category on the events page.";
            } else if (message.includes('create') || message.includes('organize')) {
                return "To create an event, you'll need to be logged in. After signing up, you can access the event creation form from your dashboard. You'll need to provide event details like title, description, date, location, and category.";
            } else if (message.includes('feature') || message.includes('what can') || message.includes('platform')) {
                return "Eventify offers event discovery, registration, user profiles, attendance tracking, certificate generation, and admin tools for event management. It's designed specifically for university clubs and student organizations.";
            } else if (message.includes('club') || message.includes('organization')) {
                return "University clubs can use Eventify to organize events, manage registrations, track attendance, and engage with students. The platform makes it easy to promote events and manage participants.";
            } else {
                return "I'm here to help with questions about Eventify, university events, and the platform features. Feel free to ask about event registration, creation, or any other platform-related questions!";
            }
        }

        // Quick question function
        window.askQuickQuestion = function(question) {
            document.getElementById('chat-input').value = question;
            sendMessage();
        };

        // Show/hide typing indicator
        function showTypingIndicator(show) {
            const indicator = document.getElementById('typing-indicator');
            if (show) {
                indicator.classList.remove('hidden');
            } else {
                indicator.classList.add('hidden');
            }
        }

        // Escape HTML to prevent XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Enter key support for chat input
        document.addEventListener('DOMContentLoaded', () => {
            const chatInput = document.getElementById('chat-input');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }
            
            // Test API connection on page load
            testGeminiAPIConnection();
        });

        // Test Gemini API connection
        async function testGeminiAPIConnection() {
            try {
                console.log('Testing Gemini API connection...');
                updateDebugPanel('api-status', 'Checking...', 'bg-yellow-500');
                
                const testResponse = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-goog-api-key': GEMINI_API_KEY
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: "Hello! Please respond with 'EventifyAI is ready to help!'"
                            }]
                        }]
                    })
                });

                if (testResponse.ok) {
                    const data = await testResponse.json();
                    if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                        console.log('âœ… Gemini API connection successful!');
                        console.log('Test response:', data.candidates[0].content.parts[0].text);
                        
                        // Update chat header to show API is connected
                        const chatHeader = document.querySelector('#ai-faq-chat .text-lead');
                        if (chatHeader) {
                            chatHeader.innerHTML = `
                                Get instant answers to any questions about events, the platform, or university activities
                                <span class="inline-flex items-center px-2 py-1 ml-2 bg-green-500/20 text-green-400 text-xs rounded-full">
                                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                                    </svg>
                                    AI Connected
                                </span>
                            `;
                        }
                        
                        updateDebugPanel('api-status', 'Connected', 'bg-green-500');
                    } else {
                        throw new Error('Invalid test response format');
                    }
                } else {
                    throw new Error(`Test failed with status: ${testResponse.status}`);
                }
                
            } catch (error) {
                console.error('âŒ Gemini API connection test failed:', error);
                
                // Update chat header to show API is not connected
                const chatHeader = document.querySelector('#ai-faq-chat .text-lead');
                if (chatHeader) {
                    chatHeader.innerHTML = `
                        Get instant answers to any questions about events, the platform, or university activities
                        <span class="inline-flex items-center px-2 py-1 ml-2 bg-yellow-500/20 text-yellow-400 text-xs rounded-full">
                            <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                            </svg>
                            Using Fallback Mode
                        </span>
                    `;
                }
                
                updateDebugPanel('api-status', 'Failed', 'bg-red-500');
            }
        }

        // Update debug panel
        function updateDebugPanel(elementId, text, bgClass) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = text;
                element.className = `px-2 py-1 rounded text-white ${bgClass}`;
            }
            
            // Update chat history count
            const historyCount = document.getElementById('chat-history-count');
            if (historyCount) {
                historyCount.textContent = `${chatHistory.length} messages`;
            }
        }

        // Clear chat history
        window.clearChatHistory = function() {
            chatHistory = [];
            const chatMessages = document.getElementById('chat-messages');
            if (chatMessages) {
                // Keep only the welcome message
                const welcomeMessage = chatMessages.querySelector('.flex.items-start.space-x-3');
                chatMessages.innerHTML = '';
                if (welcomeMessage) {
                    chatMessages.appendChild(welcomeMessage);
                }
            }
            updateDebugPanel('chat-history-count', '0 messages', 'bg-blue-500');
        };
    </script>
</body>
</html>